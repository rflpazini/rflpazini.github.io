{{- printf "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"yes\"?>" | safeHTML }}
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        xmlns:xhtml="http://www.w3.org/1999/xhtml">
{{- range $page := .Site.RegularPages }}
  {{- if not $page.Draft }}
  <url>
    <loc>{{ $page.Permalink }}</loc>
    {{- if not $page.Lastmod.IsZero }}
    <lastmod>{{ $page.Lastmod.Format "2006-01-02T15:04:05-07:00" }}</lastmod>
    {{- else if not $page.Date.IsZero }}
    <lastmod>{{ $page.Date.Format "2006-01-02T15:04:05-07:00" }}</lastmod>
    {{- end }}
    
    {{- with $page.Sitemap.ChangeFreq }}
    <changefreq>{{ . }}</changefreq>
    {{- else }}
    <changefreq>weekly</changefreq>
    {{- end }}
    
    {{- if ge $page.Sitemap.Priority 0.0 }}
    <priority>{{ $page.Sitemap.Priority }}</priority>
    {{- else }}
    <priority>0.5</priority>
    {{- end }}
    
    {{- if $page.IsTranslated }}
      {{- range $page.AllTranslations }}
    <xhtml:link rel="alternate" hreflang="{{ .Language.LanguageCode }}" href="{{ .Permalink }}" />
      {{- end }}
    {{- end }}
  </url>
  {{- end }}
{{- end }}

{{- range $page := .Site.Pages }}
  {{- if and (eq $page.Kind "section") (not $page.Draft) }}
  <url>
    <loc>{{ $page.Permalink }}</loc>
    {{- if not $page.Lastmod.IsZero }}
    <lastmod>{{ $page.Lastmod.Format "2006-01-02T15:04:05-07:00" }}</lastmod>
    {{- end }}
    <changefreq>monthly</changefreq>
    <priority>0.8</priority>
    
    {{- if $page.IsTranslated }}
      {{- range $page.AllTranslations }}
    <xhtml:link rel="alternate" hreflang="{{ .Language.LanguageCode }}" href="{{ .Permalink }}" />
      {{- end }}
    {{- end }}
  </url>
  {{- end }}
{{- end }}

{{- with .Site.Home }}
<url>
  <loc>{{ .Permalink }}</loc>
  {{- if not .Lastmod.IsZero }}
  <lastmod>{{ .Lastmod.Format "2006-01-02T15:04:05-07:00" }}</lastmod>
  {{- end }}
  <changefreq>daily</changefreq>
  <priority>1.0</priority>
  
  {{- if .IsTranslated }}
    {{- range .AllTranslations }}
  <xhtml:link rel="alternate" hreflang="{{ .Language.LanguageCode }}" href="{{ .Permalink }}" />
    {{- end }}
  {{- end }}
</url>
{{- end }}
</urlset>